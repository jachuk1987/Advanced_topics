<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Ticket Booking</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex flex-col items-center p-6">
    <h1 class="text-3xl font-bold mb-4">Movie Ticket Booking</h1>
    
    <!-- Theater Layout -->
    <div id="seats" class="grid grid-cols-10 gap-2 bg-white p-4 rounded shadow-lg"></div>
    
    <!-- Buttons -->
    <div class="mt-4">
        <button id="confirm-booking" class="bg-green-500 text-white px-4 py-2 rounded">Confirm Booking</button>
    </div>
    
    <script>
        const API_URL = "https://your-api-endpoint.com/seats"; // Replace with actual API

        // Fetch all seats from API
        async function fetchSeats() {
            try {
                const response = await fetch(API_URL);
                if (!response.ok) throw new Error("Failed to fetch seats");
                return await response.json();
            } catch (error) {
                console.error("Error fetching seats:", error);
            }
        }

        // Book selected seats via API
        async function bookSeats(selectedSeats) {
            try {
                const response = await fetch(`${API_URL}/book`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ seats: selectedSeats })
                });
                return await response.json();
            } catch (error) {
                console.error("Booking error:", error);
            }
        }

        // Render seats dynamically
        async function renderSeats() {
            const seatsContainer = document.getElementById("seats");
            seatsContainer.innerHTML = "";
            const seats = await fetchSeats();

            if (seats) {
                seats.forEach(seat => {
                    const seatButton = document.createElement("button");
                    seatButton.className = `p-2 rounded text-white font-bold ${seat.booked ? "bg-red-500" : "bg-green-500 hover:opacity-75"}`;
                    seatButton.textContent = `${seat.row}-${seat.col}`;
                    seatButton.disabled = seat.booked;
                    seatButton.onclick = () => toggleSeatSelection(seat.id);
                    seatsContainer.appendChild(seatButton);
                });
            }
        }

        let selectedSeats = [];
        function toggleSeatSelection(seatId) {
            if (selectedSeats.includes(seatId)) {
                selectedSeats = selectedSeats.filter(id => id !== seatId);
            } else {
                selectedSeats.push(seatId);
            }
        }

        document.getElementById("confirm-booking").addEventListener("click", async () => {
            const result = await bookSeats(selectedSeats);
            if (result.success) {
                alert("Booking confirmed!");
                selectedSeats = [];
                renderSeats();
            } else {
                alert("Booking failed!");
            }
        });

        // Initialize seat rendering
        document.addEventListener("DOMContentLoaded", renderSeats);
    </script>
</body>
</html>
